<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Framework: 2030 Agenda for Sustainable Development</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        
        :root {
            --primary: #000000; 
            --accent: #2563eb; 
            --habit-accent: #d97706; 
            --bg-page: #f8fafc;
            --card-bg: #ffffff;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--bg-page); 
            color: var(--primary); 
            margin: 0; 
            overflow: hidden; 
            line-height: 1.6;
        }

        /* High-Contrast Navigation Tree */
        .tree-container { padding: 40px 40px; overflow-x: auto; }
        .tree ul { padding-top: 30px; position: relative; display: flex; justify-content: center; flex-wrap: wrap; gap: 20px; max-width: 1600px; margin: 0 auto; }
        .tree li { list-style-type: none; position: relative; }
        
        .node { 
            border: 3px solid var(--primary); padding: 15px 20px; text-decoration: none; 
            color: var(--primary); font-size: 0.85rem; font-weight: 800; 
            display: flex; align-items: center; justify-content: center; border-radius: 4px; transition: all 0.2s; 
            cursor: pointer; background: var(--card-bg); box-shadow: 4px 4px 0px var(--primary);
            min-width: 260px; text-transform: uppercase; letter-spacing: 0.05em; text-align: center;
        }
        .node:hover { background: var(--primary); color: var(--card-bg); transform: translate(-2px, -2px); box-shadow: 6px 6px 0px var(--accent); }

        /* Unified Clear Modal */
        .modal { display: none; position: fixed; z-index: 1000; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(8px); overflow-y: auto; }
        .modal-content { background: var(--card-bg); margin: 0 auto; min-height: 100vh; width: 100%; max-width: 1400px; animation: fadeIn 0.3s ease; box-shadow: 0 0 50px rgba(0,0,0,0.5); border-left: 4px solid var(--primary); border-right: 4px solid var(--primary); }
        
        /* Interactive TTS Blocks */
        .speakable { cursor: pointer; transition: all 0.2s; padding: 25px; border: 2px solid transparent; position: relative; border-radius: 8px; }
        .speakable:hover { background: #f1f5f9; border-color: var(--primary); }
        .speakable::after { content: 'ðŸ”Š CLICK TO LISTEN (85% SPEED)'; position: absolute; top: 10px; right: 15px; font-size: 0.6rem; font-weight: 900; color: var(--accent); opacity: 0; transition: opacity 0.2s; letter-spacing: 0.05em; }
        .speakable:hover::after { opacity: 1; }

        /* Stakeholder Columns */
        .stakeholder-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0; border-top: 4px solid var(--primary); border-bottom: 4px solid var(--primary); background: #f8fafc; }
        .stakeholder-card { border-right: 4px solid var(--primary); padding: 30px; background: var(--card-bg); display: flex; flex-direction: column; gap: 15px; }
        .stakeholder-card:last-child { border-right: none; }
        
        .scaffold-box { background: #eff6ff; border: 2px solid var(--accent); padding: 15px; border-radius: 4px; }
        .evidence-tag { font-size: 0.65rem; font-weight: 800; background: var(--primary); color: #fff; padding: 4px 8px; text-transform: uppercase; border-radius: 2px; display: inline-block; margin-top: 5px; }

        /* Left-Justified GRASPS */
        .grasps-container { padding: 30px; background: #ffffff; }
        .grasps-item { display: flex; gap: 20px; padding: 15px 0; border-bottom: 2px solid #e2e8f0; align-items: flex-start; text-align: left; }
        .grasps-item:last-child { border-bottom: none; }
        .grasps-label { font-weight: 900; color: var(--accent); font-size: 1.8rem; width: 40px; text-align: left; line-height: 1; }
        .grasps-desc { font-weight: 900; font-size: 0.8rem; color: var(--primary); width: 120px; text-transform: uppercase; padding-top: 8px; letter-spacing: 0.1em; }
        .grasps-val { flex: 1; font-size: 1rem; font-weight: 600; color: var(--primary); padding-top: 5px; }

        .section-header { background: var(--primary); color: white; padding: 15px 30px; font-weight: 900; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.25em; }

        #activity-console { background: var(--primary); color: #ffffff; padding: 30px; font-family: 'Courier New', monospace; font-size: 0.9rem; border-left: 10px solid var(--accent); border-radius: 4px; margin: 20px 0; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- Compact Main Workspace Header -->
    <header class="bg-white border-b-[4px] border-black px-12 py-4 flex flex-col items-center text-center shrink-0 z-10">
        <h1 class="text-2xl font-black tracking-tight text-black uppercase">The 17 UN Sustainable Development Goals</h1>
    </header>

    <!-- Scrollable Goal Grid -->
    <div class="flex-1 overflow-auto bg-slate-50">
        <div class="tree-container">
            <div class="tree" id="treeRoot"></div>
        </div>
    </div>

    <!-- Detailed Single-Page Insight Modal -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <!-- Compact Modal Header -->
            <div class="bg-black text-white p-6 flex justify-between items-center border-b-[8px] border-blue-600 sticky top-0 z-50">
                <div class="max-w-4xl">
                    <p class="text-[8px] font-black uppercase tracking-[0.4em] text-blue-400 mb-1">Academic Seminar Module</p>
                    <h2 id="modalTitle" class="text-lg font-black uppercase tracking-tight leading-tight"></h2>
                </div>
                <button onclick="closeModal()" class="text-white hover:text-blue-400 text-4xl font-light leading-none px-4">&times;</button>
            </div>
            
            <div class="modal-body bg-white">
                
                <!-- Inquiry Section -->
                <div class="p-10 border-b-4 border-black speakable" onclick="speakText(this)">
                    <p class="font-black text-xs uppercase tracking-widest text-black border-b-4 border-black inline-block pb-1 mb-4">Essential Inquiry Question</p>
                    <p id="eqDisplay" class="text-2xl font-black text-black leading-snug italic"></p>
                    
                    <div class="mt-6 p-4 bg-slate-100 border-l-8 border-amber-600">
                        <p class="text-[10px] font-black uppercase tracking-widest text-amber-700 mb-1">Metacognitive Objective</p>
                        <p class="text-sm font-bold text-black leading-relaxed">Understand that disagreement often stems from different cognitive approaches, not just different opinions. Develop intellectual empathy by practicing tools outside your natural preference.</p>
                    </div>
                </div>

                <!-- Stakeholder Perspectives -->
                <div class="section-header">Stakeholder Mapping: Educational, Environmental, and Economic Perspectives</div>
                <div class="stakeholder-grid" id="stakeholder-container"></div>

                <!-- GRASPS Table -->
                <div class="grasps-container speakable" onclick="speakText(this)">
                    <p class="font-black text-xs uppercase tracking-widest text-black border-b-4 border-black inline-block pb-1 mb-6">Performance Assessment: GRASPS</p>
                    <div class="grasps-row">
                        <div class="grasps-item">
                            <div class="grasps-label">G</div>
                            <div class="grasps-desc">Goal</div>
                            <div id="grasps-g" class="grasps-val"></div>
                        </div>
                        <div class="grasps-item">
                            <div class="grasps-label">R</div>
                            <div class="grasps-desc">Role</div>
                            <div id="grasps-r" class="grasps-val font-black"></div>
                        </div>
                        <div class="grasps-item">
                            <div class="grasps-label">A</div>
                            <div class="grasps-desc">Audience</div>
                            <div id="grasps-a" class="grasps-val"></div>
                        </div>
                        <div class="grasps-item">
                            <div class="grasps-label">S</div>
                            <div class="grasps-desc">Situation</div>
                            <div id="grasps-s" class="grasps-val italic"></div>
                        </div>
                        <div class="grasps-item">
                            <div class="grasps-label">P</div>
                            <div class="grasps-desc">Product</div>
                            <div id="grasps-p" class="grasps-val font-black underline decoration-blue-600 decoration-4 underline-offset-4"></div>
                        </div>
                        <div class="grasps-item">
                            <div class="grasps-label">S</div>
                            <div class="grasps-desc">Standards</div>
                            <div class="grasps-val">KASEC Academic Rubric (Knowledge, Analysis, Structure, Evidence, Clarity)</div>
                        </div>
                    </div>
                </div>

                <!-- Debate Dynamics Console -->
                <div class="p-10 bg-slate-100 border-t-8 border-black">
                    <p class="font-black text-xs uppercase tracking-widest text-black border-b-4 border-black inline-block pb-1 mb-6">Debate Preparation: Cognitive Sprint</p>
                    <p class="text-sm font-bold mb-6 text-black">Explicitly teach the cognitive tool and habit alongside SDG content. Model the behavior below to craft more nuanced arguments that anticipate opposition.</p>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <div class="p-6 bg-white border-4 border-black">
                            <h4 class="text-[10px] font-black uppercase mb-3 text-blue-600 tracking-widest">Cognitive Strategy Activity</h4>
                            <p class="text-sm font-bold leading-relaxed italic text-black" id="tool-prompt-text"></p>
                        </div>
                        <div class="p-6 bg-white border-4 border-black">
                            <h4 class="text-[10px] font-black uppercase mb-3 text-amber-600 tracking-widest">Behavioral Habit Modeling</h4>
                            <p class="text-sm font-bold leading-relaxed italic text-black" id="habit-prompt-text"></p>
                        </div>
                    </div>
                    
                    <div id="activity-console" class="shadow-xl">
                        <button onclick="startActivity()" class="w-full bg-white text-black py-4 font-black uppercase text-xs tracking-[0.2em] hover:bg-blue-600 hover:text-white transition-all border-4 border-white mb-6">Initiate Metacognitive Sprint</button>
                        <div id="console-output" class="space-y-4"></div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // Detailed and unique data for all 17 SDGs, designed for secondary students.
        const curriculumData = [
            { id: 1, name: "1: No Poverty", eq: "Should wealth redistribution be mandatory?", tool: "Systems Mapping", habit: "Persisting",
              grasps: { g: "Design a systemic redistribution model.", r: "Economic Advisor", a: "Policy Committee", s: "Poverty is rising despite GDP growth.", p: "Policy Proposal & Impact Model" },
              stakeholders: [
                { role: "Educational", tool: "Perspective-Taking", habit: "Listening with Empathy", for: "Center marginalized voices in economic planning.", against: "Consider implementation challenges of massive redistribution.", scaffold: "While recognizing the systemic need for..., we must consider...", evidence: "Sociological case studies", prompt: "Write one sentence from the viewpoint of someone directly affected by educational fee hikes." },
                { role: "Environmental", tool: "Systems Mapping", habit: "Thinking Interdependently", for: "Map poverty's root causes to resource scarcity.", against: "Ensure ecological sustainability of relief solutions.", scaffold: "There is a direct correlation between resource access and...", evidence: "GIS mapping data", prompt: "Draw three distinct connections between soil health and the local unemployment rate." },
                { role: "Economic", tool: "Futures Thinking", habit: "Applying Past Knowledge", for: "Invest heavily in human capital for future returns.", against: "Avoid disincentivizing workforce productivity.", scaffold: "Based on historical economic patterns, a mandatory shift...", evidence: "Longitudinal GDP data", prompt: "Cite one specific data point where a tax framework failed to stimulate long-term growth." }
              ]},
            { id: 2, name: "2: Zero Hunger", eq: "Should GMO crops be widely adopted?", tool: "Pattern Recognition", habit: "Gathering Data",
              grasps: { g: "Resolve a regional food security crisis.", r: "Food Strategist", a: "Health Organization", s: "Traditional supply chains are failing nutritional needs.", p: "Tech vs. Traditional Strategy Report" },
              stakeholders: [
                { role: "Educational", tool: "Perspective-Taking", habit: "Managing Impulsivity", for: "Address immediate food needs urgently.", against: "Consider long-term educational impacts on farming knowledge.", scaffold: "Though the immediate yield is attractive, the long-term cost to...", evidence: "Agronomy education reports", prompt: "Create a visual model showing how gene-splicing results in increased crop durability." },
                { role: "Environmental", tool: "Pattern Recognition", habit: "Gathering Data Through Senses", for: "Increase yield sustainably on existing land.", against: "Monitor severe biodiversity impacts.", scaffold: "The recurring pattern in this environmental data indicates...", evidence: "Biodiversity trackers", prompt: "Identify the pattern of bird migration in fields using non-modified versus modified seeds." },
                { role: "Economic", tool: "Modeling", habit: "Creating, Imagining", for: "Scale efficient global food production.", against: "Protect local smallholder livelihoods from monopolies.", scaffold: "If we model this patent structure globally, the result for...", evidence: "Patent monopoly archives", prompt: "Explain how seed patents are analogous to mobile app store developer fees." }
              ]},
            { id: 3, name: "3: Good Health and Well-being", eq: "Should healthcare be fully privatized to increase quality?", tool: "Ethical Reasoning", habit: "Striving for Accuracy",
              grasps: { g: "Design a universal health pilot.", r: "Policy Analyst", a: "Ministry of Health", s: "Disparity between urban and rural life expectancy.", p: "National Health Equity Plan" },
              stakeholders: [
                { role: "Educational", tool: "Ethical Reasoning", habit: "Striving for Accuracy", for: "Ensure health literacy access through private competition.", against: "Prevent the spread of medical misinformation among the poor.", scaffold: "Ethically, if we construct a system based on profit, we risk...", evidence: "Public health literacy data", prompt: "Cite a data point regarding healthcare literacy in privatized systems." },
                { role: "Environmental", tool: "Visualizing", habit: "Wonderment & Awe", for: "Connect human health directly to healthy ecosystems.", against: "Consider the massive waste produced in private medical supply chains.", scaffold: "Visualize the supply chain: the byproduct of this care is...", evidence: "Medical waste statistics", prompt: "Imagine a hospital design that functions as a natural carbon sink." },
                { role: "Economic", tool: "Systems Mapping", habit: "Metacognition", for: "Optimize resource allocation through market forces.", against: "Ensure equitable access to life-saving treatments.", scaffold: "Tracing the financial system maps directly to patient outcomes, showing...", evidence: "Health economics journals", prompt: "Map the connection between patient insurance premiums and pharmaceutical R&D." }
              ]},
            { id: 4, name: "4: Quality Education", eq: "Should higher education be free for all citizens?", tool: "Metacognition", habit: "Remaining Open to Learning",
              grasps: { g: "Assess economic ROI of free degrees.", r: "Academic Dean", a: "State Budget Office", s: "Student debt is crippling the workforce.", p: "Education Funding Manifesto" },
              stakeholders: [
                { role: "Educational", tool: "Metacognition", habit: "Remaining Open to Learning", for: "Democratize knowledge access completely.", against: "Maintain academic rigor and institutional standards.", scaffold: "Reflecting on the purpose of higher education, we must ask if...", evidence: "University enrollment metrics", prompt: "List one valid point from the opposing view regarding degree inflation." },
                { role: "Environmental", tool: "Ethical Reasoning", habit: "Listening with Empathy", for: "Teach sustainability as a universal core value.", against: "Balance digital learning expansion with physical nature connection.", scaffold: "The ethical imperative dictates that education must include...", evidence: "Eco-literacy frameworks", prompt: "Explain how educational access directly affects climate resilience." },
                { role: "Economic", tool: "Futures Thinking", habit: "Taking Responsible Risks", for: "Build a highly skilled workforce for the 2050 economy.", against: "Manage the massive public funding sustainability.", scaffold: "Projecting these costs into the next decade, the ROI of free tuition...", evidence: "Macro-economic forecasts", prompt: "Predict the state of national innovation in 2050 if degrees remain expensive." }
              ]},
            { id: 5, name: "5: Gender Equality", eq: "Should gender quotas be mandatory in corporate boards?", tool: "Perspective-Taking", habit: "Thinking Flexibly",
              grasps: { g: "Redesign executive recruitment.", r: "DEI Consultant", a: "Fortune 500 Board", s: "Only 10% of senior leadership is female.", p: "Corporate Equity Audit" },
              stakeholders: [
                { role: "Educational", tool: "Perspective-Taking", habit: "Thinking Flexibly", for: "Challenge systemic biases explicitly in curriculum.", against: "Focus purely on merit-based evaluation systems.", scaffold: "From the perspective of a marginalized candidate, a quota acts as...", evidence: "Sociological bias studies", prompt: "Write a sentence from the view of a qualified candidate passed over for a quota." },
                { role: "Environmental", tool: "Systems Mapping", habit: "Thinking Interdependently", for: "Recognize women as key global climate leaders.", against: "Avoid essentializing specific gender roles in science.", scaffold: "Mapping corporate diversity to ESG scores reveals that...", evidence: "Corporate sustainability reports", prompt: "Map the link between board diversity and corporate ESG scores." },
                { role: "Economic", tool: "Modeling", habit: "Creating, Imagining", for: "Unlock the full economic potential of all demographics.", against: "Ensure smooth transition without shocking specialized industries.", scaffold: "Economic models consistently show that diverse leadership teams...", evidence: "Global market performance data", prompt: "Brainstorm a new way to incentivize diversity without rigid quotas." }
              ]},
            { id: 6, name: "6: Clean Water and Sanitation", eq: "Should water be treated as a commodity or a human right?", tool: "Dimensional Thinking", habit: "Managing Impulsivity",
              grasps: { g: "Manage a severe drought crisis.", r: "Water Commissioner", a: "Industrial and Public Stakeholders", s: "Water levels at record lows.", p: "Emergency Allocation & Pricing Policy" },
              stakeholders: [
                { role: "Educational", tool: "Pattern Recognition", habit: "Gathering Data", for: "Teach strict water stewardship and valuation.", against: "Address hygiene access as an undeniable human right.", scaffold: "The pattern of water pricing directly correlates with...", evidence: "Hydrological usage data", prompt: "Observe the soil texture differences between two differently priced plots." },
                { role: "Environmental", tool: "Systems Mapping", habit: "Thinking Interdependently", for: "Value the ecosystem services of natural watersheds.", against: "Prevent industrial contamination from 'paying to pollute'.", scaffold: "Within the broader ecological system, commodifying water...", evidence: "Watershed conservation data", prompt: "Draw connections between urban water runoff and local fish populations." },
                { role: "Economic", tool: "Modeling", habit: "Creating, Imagining", for: "Incentivize efficiency and tech (desalination) through pricing.", against: "Protect vulnerable populations from price gouging.", scaffold: "If we model the price elasticity of water, the lowest quartile...", evidence: "Utility pricing models", prompt: "Create a visual model of a 'sliding scale' pricing system." }
              ]},
            { id: 7, name: "7: Affordable and Clean Energy", eq: "Should nuclear energy be categorized as 'green'?", tool: "Analogizing", habit: "Striving for Accuracy",
              grasps: { g: "Select a national energy mix.", r: "Grid Architect", a: "Environmental Agency", s: "Renewables are intermittent and coal is fading.", p: "2050 Energy Decarbonization Roadmap" },
              stakeholders: [
                { role: "Educational", tool: "Modeling", habit: "Striving for Accuracy", for: "Bridge the advanced energy literacy gap.", against: "Consider long-term waste management education needs.", scaffold: "Statistically accurate models of reactor safety demonstrate...", evidence: "Nuclear engineering data", prompt: "Cite a specific data point regarding the safety record of modern reactors." },
                { role: "Environmental", tool: "Visualizing", habit: "Wonderment & Awe", for: "Decarbonize the energy grid rapidly with minimal land use.", against: "Assess uranium mining and thermal habitat impacts.", scaffold: "Visualizing the land footprint of solar versus nuclear reveals...", evidence: "Land-use environmental impact studies", prompt: "Imagine a world where power plants are also wildlife sanctuaries." },
                { role: "Economic", tool: "Futures Thinking", habit: "Taking Responsible Risks", for: "Ensure absolute base-load power stability for industry.", against: "Manage immensely high capital and decommissioning costs.", scaffold: "Projecting construction costs over a 60-year lifespan...", evidence: "Energy capital expenditure reports", prompt: "Predict the cost of energy in 2060 comparing Nuclear vs. Solar + Storage." }
              ]},
            { id: 8, name: "8: Decent Work and Economic Growth", eq: "Should a Universal Basic Income be implemented due to AI?", tool: "Futures Thinking", habit: "Creating, Imagining",
              grasps: { g: "Mitigate mass automation job loss.", r: "Labor Union Lead", a: "Economic Council", s: "Manufacturing automation is replacing 40% of labor.", p: "Post-Work Economic Stability Plan" },
              stakeholders: [
                { role: "Educational", tool: "Collaborative Sense-making", habit: "Thinking Interdependently", for: "Retrain specifically for human-centric, empathetic roles.", against: "Avoid stifling technological curiosity in students.", scaffold: "Working collaboratively, we must determine if taxing tech...", evidence: "Labor displacement forecasts", prompt: "List one valid point from a coder whose job is being automated." },
                { role: "Environmental", tool: "Systems Mapping", habit: "Thinking Interdependently", for: "Promote massive green job transitions using tax revenue.", against: "Ensure sustainable supply chains for massive AI server farms.", scaffold: "The energy system required to run AI models suggests...", evidence: "Server farm carbon footprint data", prompt: "Map the energy consumption of AI versus the efficiency it creates." },
                { role: "Economic", tool: "Futures Thinking", habit: "Creating & Innovating", for: "Fund robust social safety nets (like UBI).", against: "Maintain global industrial and technological competitiveness.", scaffold: "Looking to the future, a country that taxes innovation may...", evidence: "Global tech competitiveness indices", prompt: "Propose one daring policy to keep a country competitive while taxing AI." }
              ]},
            { id: 9, name: "9: Industry, Innovation and Infrastructure", eq: "Should space exploration take priority over Earth's bridges?", tool: "Visualizing", habit: "Taking Responsible Risks",
              grasps: { g: "Justify a 50B space budget.", r: "Aerospace Director", a: "Taxpayers", s: "Infrastructure is failing but Mars is reachable.", p: "Strategic Frontier Priority Report" },
              stakeholders: [
                { role: "Educational", tool: "Design Thinking", habit: "Taking Responsible Risks", for: "Inspire next-gen STEM careers through grand challenges.", against: "Focus on immediate, practical local engineering needs.", scaffold: "Applying design thinking to terrestrial problems yields...", evidence: "STEM enrollment statistics", prompt: "Imagine a school curriculum centered entirely around Mars colonization." },
                { role: "Environmental", tool: "Pattern Recognition", habit: "Gathering Data", for: "Monitor Earth's climate via advanced satellite tech.", against: "Reduce orbital debris and atmospheric space-launch emissions.", scaffold: "The pattern of atmospheric disruption caused by launches...", evidence: "Atmospheric chemistry data", prompt: "Identify the pattern of satellite coverage over deforestation zones." },
                { role: "Economic", tool: "Modeling", habit: "Creating, Imagining", for: "Unlock new resource frontiers (asteroid mining).", against: "Prioritize terrestrial economic stability and ROI.", scaffold: "Economic models of off-planet resource extraction indicate...", evidence: "Aerospace economic analyses", prompt: "Explain how space tech is analogous to the early internet ROI." }
              ]},
            { id: 10, name: "10: Reduced Inequalities", eq: "Should schools prioritize global citizenship over heritage?", tool: "Perspective-Taking", habit: "Thinking Flexibly",
              grasps: { g: "Design a dual-identity curriculum.", r: "Curriculum Specialist", a: "National School Board", s: "Globalization is erasing local dialects.", p: "Heritage vs. Global Integrated Syllabus" },
              stakeholders: [
                { role: "Educational", tool: "Recontextualizing", habit: "Thinking Flexibly", for: "Develop global empathy to solve international crises.", against: "Without heritage identity, students risk becoming culturally rootless.", scaffold: "I see the value in global skills; however, we must consider...", evidence: "Identity development literature", prompt: "Write a sentence from the view of a student whose language is dying." },
                { role: "Environmental", tool: "Ethical Reasoning", habit: "Thinking with Clarity", for: "Address global climate justice as a unified species.", against: "Protect and prioritize indigenous environmental wisdom.", scaffold: "Ethically, we cannot solve global issues without consulting...", evidence: "Indigenous ecological archives", prompt: "Explain how 'global' identity might ignore local ecological needs." },
                { role: "Economic", tool: "Futures Thinking", habit: "Open to Learning", for: "Prepare students for highly mobile global labor markets.", against: "Ensure local workforce relevance and community brain-drain prevention.", scaffold: "Projecting labor needs, a purely globalized student may lack...", evidence: "Global labor mobility reports", prompt: "Predict the state of tourism in 2040 if all cultures become 'Globalized'." }
              ]},
            { id: 11, name: "11: Sustainable Cities and Communities", eq: "Should cars be banned from all city centers?", tool: "Systems Mapping", habit: "Thinking Interdependently",
              grasps: { g: "Transform a traffic-heavy district.", r: "Urban Planner", a: "Retailers and Residents", s: "Air quality is 4x dangerous limits.", p: "Pedestrian District Transition Model" },
              stakeholders: [
                { role: "Educational", tool: "Dimensional Thinking", habit: "Managing Impulsivity", for: "Promote pedestrian-safe, outdoor learning zones.", against: "Address accessibility concerns for diverse and disabled learners.", scaffold: "Viewing the city dimensionally, removing cars alters the space for...", evidence: "Urban accessibility studies", prompt: "Look at the cost of public transit over 50 years versus road repair." },
                { role: "Environmental", tool: "Systems Mapping", habit: "Thinking Interdependently", for: "Drastically reduce urban heat islands and particulate pollution.", against: "Plan for efficient, low-emission delivery logistics to replace vans.", scaffold: "The urban system relies on logistics; if cars are removed...", evidence: "Urban air quality metrics", prompt: "Draw connections between car-free streets and local bird populations." },
                { role: "Economic", tool: "Modeling", habit: "Creating, Imagining", for: "Increase foot traffic which boosts local retail sales.", against: "Manage the massive transit infrastructure upgrade costs.", scaffold: "Modeling foot-traffic economics shows a correlation with...", evidence: "Retail economics in pedestrian zones", prompt: "Brainstorm a new method for 'Last Mile' delivery without vans." }
              ]},
            { id: 12, name: "12: Responsible Consumption and Production", eq: "Should planned obsolescence be illegal?", tool: "Pattern Recognition", habit: "Questioning Problems",
              grasps: { g: "Regulate the electronics industry.", r: "Consumer Advocate", a: "Tech Giants & Gov", s: "E-waste is the fastest growing waste stream.", p: "Right-to-Repair Legislation Proposal" },
              stakeholders: [
                { role: "Educational", tool: "Systems Mapping", habit: "Metacognition", for: "Teach lifecycle thinking and repair skills.", against: "Encourage repair-culture without stalling technological advancement.", scaffold: "When mapping the lifecycle of a smartphone, the critical flaw is...", evidence: "Lifecycle analysis reports", prompt: "Trace your logic path: Why did you buy your last phone?" },
                { role: "Environmental", tool: "Pattern Recognition", habit: "Gathering Data", for: "Minimize landfill toxicity and heavy metal leakage.", against: "Monitor material sourcing ethics for 'new' green tech.", scaffold: "The data pattern clearly shows that e-waste exports...", evidence: "E-waste toxicity data", prompt: "Cite a data point regarding the lifespan of a modern smartphone." },
                { role: "Economic", tool: "Futures Thinking", habit: "Taking Responsible Risks", for: "Promote massive circular business models and repair jobs.", against: "Balance innovation product cycles with hardware longevity.", scaffold: "A future strictly banning planned obsolescence would force markets to...", evidence: "Circular economy forecasts", prompt: "Predict the state of landfills in 2070 if we don't ban obsolescence." }
              ]},
            { id: 13, name: "13: Climate Action", eq: "Should a global carbon tax be mandatory?", tool: "Futures Thinking", habit: "Taking Responsible Risks",
              grasps: { g: "Negotiate a tri-nation carbon deal.", r: "Climate Envoy", a: "G20 Leaders", s: "CO2 levels at tipping point.", p: "Universal Carbon Pricing Accord" },
              stakeholders: [
                { role: "Educational", tool: "Futures Thinking", habit: "Questioning Problems", for: "Analyze intergenerational equity (who pays for the past?).", against: "Focus on local community adaptation rather than global taxes.", scaffold: "If we project this tax, the fundamental question becomes...", evidence: "Climate equity literature", prompt: "Ask: Is it fair to tax a country that didn't cause the industrial CO2?" },
                { role: "Environmental", tool: "Systems Mapping", habit: "Thinking Interdependently", for: "Internalize environmental costs directly into product prices.", against: "Monitor carbon leakage (industries moving to untaxed nations).", scaffold: "In a globalized system, a localized tax simply shifts the burden to...", evidence: "Carbon leakage economic data", prompt: "Identify how a carbon tax in China affects the Amazon rainforest." },
                { role: "Economic", tool: "Modeling", habit: "Creating, Imagining", for: "Incentivize massive green tech investment.", against: "Avoid disproportionate financial impacts on small firms.", scaffold: "Economic models of carbon pricing demonstrate a shift toward...", evidence: "Green tech investment trends", prompt: "Propose a way to redistribute carbon tax revenue to the poor." }
              ]},
            { id: 14, name: "14: Life Below Water", eq: "Should deep-sea mining be permitted for green tech?", tool: "Visualizing", habit: "Responding with Wonderment",
              grasps: { g: "Permit or ban a mining site.", r: "Maritime Authority", a: "Mining Corp & Biologists", s: "Sea floor has cobalt but unknown biodiversity.", p: "Deep Sea Extraction Impact Study" },
              stakeholders: [
                { role: "Educational", tool: "Visualizing", habit: "Wonderment & Awe", for: "Study entirely unknown marine biodiversity.", against: "Teach oceanic interconnectedness and preservation.", scaffold: "Visualizing the deep sea ecosystem, we must acknowledge...", evidence: "Deep sea biology reports", prompt: "Sketch a creature that might live in a thermal vent." },
                { role: "Environmental", tool: "Pattern Recognition", habit: "Gathering Data", for: "Protect fragile thermal vent ecosystems.", against: "Monitor extreme noise and light pollution impacts.", scaffold: "Data patterns from exploratory mining show severe disruption to...", evidence: "Marine acoustic pollution data", prompt: "Cite a data point regarding deep-ocean oxygen production." },
                { role: "Economic", tool: "Modeling", habit: "Taking Responsible Risks", for: "Extract critical minerals necessary for EV batteries.", against: "Ensure long-term sustainable ocean economies aren't destroyed.", scaffold: "While the mineral value is high, modeling the cost of habitat loss...", evidence: "Rare earth mineral market analyses", prompt: "Look at the cost of cobalt over 50 years: Land vs. Sea." }
              ]},
            { id: 15, name: "15: Life on Land", eq: "Should rewilding take precedence over agriculture?", tool: "Systems Mapping", habit: "Thinking Interdependently",
              grasps: { g: "Allocate a 500-mile wildlife corridor.", r: "Land Use Director", a: "Farmers and Ecologists", s: "Species migration is blocked by soy farms.", p: "National Rewilding & Food Security Map" },
              stakeholders: [
                { role: "Educational", tool: "Pattern Recognition", habit: "Gathering Data", for: "Foster eco-literacy through immersion in wild spaces.", against: "Preserve traditional agricultural and ecological knowledge.", scaffold: "Observing land use patterns, the prioritization of rewilding supports...", evidence: "Eco-literacy educational outcomes", prompt: "Identify the pattern of tree growth in old vs. new forests." },
                { role: "Environmental", tool: "Visualizing", habit: "Wonderment & Awe", for: "Restore apex predators and biodiversity corridors.", against: "Consider the realistic limits of severe habitat fragmentation.", scaffold: "If we visualize a rewilded landscape, the immediate conflict is...", evidence: "Keystone species reintroduction data", prompt: "Imagine a city where wolves and humans coexist safely." },
                { role: "Economic", tool: "Systems Mapping", habit: "Thinking Interdependently", for: "Value natural ecosystem services (water/air filtration).", against: "Ensure absolute national food security and export revenues.", scaffold: "Mapping the economic value of a forest against crop yield shows...", evidence: "Ecosystem service valuations", prompt: "Map the connection between bee populations and soy farm profits." }
              ]},
            { id: 16, name: "16: Peace, Justice and Strong Institutions", eq: "Should social media be regulated for misinformation?", tool: "Ethical Reasoning", habit: "Thinking with Clarity",
              grasps: { g: "Draft a Truth in Media act.", r: "High Court Judge", a: "Platforms & Human Rights Groups", s: "Fake news is triggering unrest.", p: "Content Regulation Framework" },
              stakeholders: [
                { role: "Educational", tool: "Ethical Reasoning", habit: "Thinking with Clarity", for: "Teach media literacy to combat algorithmic bias.", against: "Protect academic freedom and free speech absolutely.", scaffold: "Ethically reasoning through censorship, the primary danger is...", evidence: "Media literacy academic studies", prompt: "Define 'Truth' with enough precision for a legal document." },
                { role: "Environmental", tool: "Perspective-Taking", habit: "Listening with Empathy", for: "Amplify marginalized environmental voices suppressed by bots.", against: "Ensure diverse, unorthodox viewpoints remain in climate discourse.", scaffold: "From the perspective of a marginalized activist, unregulated platforms...", evidence: "Digital sociology research", prompt: "Write a sentence from the view of a scientist whose data was flagged." },
                { role: "Economic", tool: "Collaborative Sense-making", habit: "Thinking Interdependently", for: "Build trust in democratic institutions to stabilize markets.", against: "Avoid government overreach that destroys tech innovation.", scaffold: "Collaboratively, we must balance market innovation with the need for...", evidence: "Institutional trust economic metrics", prompt: "Acknowledge the value of free speech while questioning its profit motive." }
              ]},
            { id: 17, name: "17: Partnerships for the Goals", eq: "Should developed nations fund global climate adaptation?", tool: "Collaborative Sense-making", habit: "Thinking Interdependently",
              grasps: { g: "Broker a $100B North-South fund.", r: "International Mediator", a: "Global Finance Ministers", s: "Islands are sinking while industry thrives.", p: "Global Equity Finance Treaty" },
              stakeholders: [
                { role: "Educational", tool: "Collaborative Sense-making", habit: "Thinking Interdependently", for: "Promote true global citizenship education through shared resources.", against: "Ensure local curriculum relevance isn't overshadowed by global agendas.", scaffold: "Making sense of global funding, the educational priority should be...", evidence: "Global citizenship pedagogy", prompt: "Merge the view of a taxpayer in Norway and a farmer in Fiji." },
                { role: "Environmental", tool: "Systems Mapping", habit: "Thinking Interdependently", for: "Address transboundary environmental issues (pollution knows no borders).", against: "Respect indigenous knowledge systems over western-funded solutions.", scaffold: "Because environmental systems are borderless, funding must...", evidence: "Transboundary pollution data", prompt: "Identify how a carbon tax in London helps a forest in Congo." },
                { role: "Economic", tool: "Futures Thinking", habit: "Applying Past Knowledge", for: "Invest heavily now to ensure global stability and prevent climate refugees.", against: "Ensure strict accountability mechanisms for all international transfers.", scaffold: "Applying past knowledge of foreign aid, we must ensure that...", evidence: "International aid effectiveness studies", prompt: "Cite a historical example where a global partnership failed to last." }
              ]}
        ];

        let activeItem = curriculumData[0];

        function renderTree() {
            const root = document.getElementById('treeRoot');
            let html = '<ul>';
            curriculumData.forEach(item => {
                html += `<li><div class="node" onclick="openModal(${item.id})">${item.name}</div></li>`;
            });
            html += '</ul>';
            if(root) root.innerHTML = html;
        }

        function openModal(id) {
            activeItem = curriculumData.find(i => i.id === id);
            
            const titleEl = document.getElementById('modalTitle');
            if(titleEl) titleEl.innerText = activeItem.name;
            
            const eqEl = document.getElementById('eqDisplay');
            if(eqEl) eqEl.innerText = `"${activeItem.eq}"`;

            // Identify Active Tool and Habit with fallback
            const activeTool = activeItem.stakeholders[0].tool || activeItem.tool || "Cognitive Tool";
            const activeHabit = activeItem.stakeholders[0].habit || activeItem.habit || "Habit of Mind";

            // Stakeholders
            const container = document.getElementById('stakeholder-container');
            if(container) {
                container.innerHTML = activeItem.stakeholders.map(s => `
                    <div class="stakeholder-card speakable" onclick="speakText(this)">
                        <div>
                            <p class="text-[10px] font-black uppercase text-blue-600 mb-2 tracking-[0.2em] border-b-2 border-blue-600 inline-block">${s.role} Perspective</p>
                            <p class="text-lg font-black text-black uppercase leading-tight mt-4">${s.tool || activeItem.tool || 'Cognitive Tool'}</p>
                            <p class="text-xs font-bold text-amber-600 uppercase mt-1 tracking-widest">${s.habit || activeItem.habit || 'Habit of Mind'}</p>
                        </div>
                        
                        <div class="mt-6 space-y-4">
                            <div>
                                <p class="text-[9px] font-black uppercase text-black mb-1 tracking-widest">FOR Argument</p>
                                <p class="text-sm font-bold text-black italic leading-relaxed border-l-4 border-blue-600 pl-3">${s.for}</p>
                            </div>
                            <div>
                                <p class="text-[9px] font-black uppercase text-black mb-1 tracking-widest">AGAINST Argument</p>
                                <p class="text-xs font-medium text-black leading-relaxed border-l-4 border-amber-600 pl-3">${s.against}</p>
                            </div>
                        </div>

                        <div class="scaffold-box mt-4">
                            <p class="text-[9px] font-black uppercase text-black mb-1 tracking-widest">Language Scaffold (B2/C1)</p>
                            <p class="text-xs text-black italic font-semibold leading-relaxed">"${s.scaffold}"</p>
                            <p class="evidence-tag mt-2">Evidence: ${s.evidence}</p>
                        </div>
                    </div>
                `).join('');
            }

            // Prompts
            const toolNameEl = document.getElementById('active-tool-name');
            if(toolNameEl) toolNameEl.innerText = activeTool;
            
            const habitNameEl = document.getElementById('active-habit-name');
            if(habitNameEl) habitNameEl.innerText = activeHabit;

            const toolPromptEl = document.getElementById('tool-prompt-text');
            if(toolPromptEl) toolPromptEl.innerText = `"${activeTool}: ${activeItem.stakeholders[0].prompt}"`;
            
            const habitPromptEl = document.getElementById('habit-prompt-text');
            if(habitPromptEl) habitPromptEl.innerText = `"${activeHabit}: List one valid empirical data point from the opposing view to build intellectual empathy."`;

            // GRASPS
            const gEl = document.getElementById('grasps-g'); if(gEl) gEl.innerText = activeItem.grasps.g;
            const rEl = document.getElementById('grasps-r'); if(rEl) rEl.innerText = activeItem.grasps.r;
            const aEl = document.getElementById('grasps-a'); if(aEl) aEl.innerText = activeItem.grasps.a;
            const sEl = document.getElementById('grasps-s'); if(sEl) sEl.innerText = activeItem.grasps.s;
            const pEl = document.getElementById('grasps-p'); if(pEl) pEl.innerText = activeItem.grasps.p;

            const modalEl = document.getElementById('detailModal');
            if(modalEl) {
                modalEl.style.display = "block";
                document.body.style.overflow = "hidden";
            }
            
            speakByVoice(`Initializing academic framework for ${activeItem.name}. Analyze the structural tensions between stakeholders.`, 'Andrew');
        }

        function closeModal() {
            const modalEl = document.getElementById('detailModal');
            if(modalEl) modalEl.style.display = "none";
            document.body.style.overflow = "auto";
            window.speechSynthesis.cancel();
        }

        function startActivity() {
            const output = document.getElementById('console-output');
            if(!output) return;
            
            output.innerHTML = `<p class="text-blue-400 font-black tracking-widest uppercase text-xs">> BOOTING COGNITIVE SPRINT...</p>`;
            
            const activeTool = activeItem.stakeholders[0].tool || activeItem.tool || "Cognitive Tool";
            setTimeout(() => {
                const prompt = `WORKSHOP CHALLENGE: 1. Acknowledge the opposition. 2. Analyze the evidence. 3. Bridge the gap using ${activeTool}. Respond to: "${activeItem.eq}"`;
                output.innerHTML += `<p class="mt-6 text-white font-bold leading-relaxed border-l-4 border-blue-500 pl-4 text-sm animate-pulse">> ${prompt}</p>`;
                speakByVoice(prompt, 'Andrew');
            }, 1000);
        }

        function speakText(container) {
            if(!container) return;
            const originalBg = container.style.backgroundColor;
            container.style.backgroundColor = '#e2e8f0';
            setTimeout(() => container.style.backgroundColor = originalBg, 200);

            const text = container.innerText.replace(/ðŸ”Š CLICK TO LISTEN \(85% SPEED\)/g, '');
            const voice = text.includes('Environmental') || text.includes('Habit') ? 'Emma' : 'Andrew';
            speakByVoice(text, voice);
        }

        function speakByVoice(text, voiceName) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                
                // MANDATORY 85% SPEED
                utterance.rate = 0.85; 
                
                const voices = window.speechSynthesis.getVoices();
                const target = voices.find(v => {
                    if (voiceName === 'Andrew') return v.name.includes('David') || v.name.includes('Male') || v.name.includes('Andrew');
                    if (voiceName === 'Emma') return v.name.includes('Zira') || v.name.includes('Female') || v.name.includes('Emma');
                    return false;
                });
                
                if (target) utterance.voice = target;
                window.speechSynthesis.speak(utterance);
            }
        }

        window.onclick = e => { if (e.target.id === 'detailModal') closeModal(); };
        window.onload = () => {
            renderTree();
            window.speechSynthesis.getVoices(); // Pre-load voices
        };
    </script>
</body>
</html>
